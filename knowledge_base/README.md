# üìö Hume Health Knowledge Base

**RAG-powered business knowledge system for the Hume AI agent**

---

## üéØ **WHAT THIS IS**

A structured repository of Hume Health's business knowledge that powers RAG (Retrieval Augmented Generation) for the Strategy Agent.

**Architecture**: Based on your n8n workflow
- ‚úÖ OpenAI `text-embedding-3-small` embeddings (1536 dimensions)
- ‚úÖ RecursiveCharacterTextSplitter (400 char chunks, 50 overlap)
- ‚úÖ Supabase pgvector storage
- ‚úÖ Semantic search via `match_knowledge_base` function

**What it enables**:
- Agent gives **Hume-specific** recommendations (not generic)
- Uses **YOUR** ICP, messaging, playbooks, and learnings
- References actual business data in strategic decisions
- Acts like it truly knows **YOUR** business

---

## ‚ö° **QUICK START**

```bash
# 1. Install dependencies
pip install -r requirements.txt

# 2. Set environment variables (in your .env)
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_KEY=your-service-role-key
OPENAI_API_KEY=sk-...

# 3. Run setup (prints SQL to run in Supabase)
python kb_loader.py --setup

# 4. Create your business documents
mkdir -p business strategy playbooks intelligence
# Add .md files with your business knowledge

# 5. Load into Supabase
python kb_loader.py --load

# 6. Test retrieval
python kb_loader.py --test "What's our ICP for dental clinics?"
```

**OR use the automated script**:
```bash
./quickstart.sh
```

---

## üìÅ **DIRECTORY STRUCTURE**

```
/knowledge_base/
  ‚îú‚îÄ‚îÄ kb_loader.py              # Main loading script
  ‚îú‚îÄ‚îÄ requirements.txt          # Dependencies
  ‚îú‚îÄ‚îÄ SETUP_GUIDE.md           # Detailed setup instructions
  ‚îú‚îÄ‚îÄ README.md                # This file
  ‚îú‚îÄ‚îÄ quickstart.sh            # Automated setup script
  ‚îÇ
  ‚îú‚îÄ‚îÄ /business/               # Business fundamentals
  ‚îÇ   ‚îú‚îÄ‚îÄ company_overview.md.template
  ‚îÇ   ‚îú‚îÄ‚îÄ company_overview.md  # ‚Üê Create this
  ‚îÇ   ‚îú‚îÄ‚îÄ unit_economics.md    # ‚Üê Create this
  ‚îÇ   ‚îî‚îÄ‚îÄ ...
  ‚îÇ
  ‚îú‚îÄ‚îÄ /strategy/               # Strategic context
  ‚îÇ   ‚îú‚îÄ‚îÄ icp_profile.md.template
  ‚îÇ   ‚îú‚îÄ‚îÄ icp_profile.md       # ‚Üê Create this
  ‚îÇ   ‚îú‚îÄ‚îÄ messaging_framework.md
  ‚îÇ   ‚îî‚îÄ‚îÄ ...
  ‚îÇ
  ‚îú‚îÄ‚îÄ /playbooks/              # Sales playbooks
  ‚îÇ   ‚îú‚îÄ‚îÄ qualification_criteria.md
  ‚îÇ   ‚îú‚îÄ‚îÄ objection_handling.md
  ‚îÇ   ‚îî‚îÄ‚îÄ ...
  ‚îÇ
  ‚îú‚îÄ‚îÄ /intelligence/           # Market intelligence
  ‚îÇ   ‚îú‚îÄ‚îÄ competitor_analysis.md
  ‚îÇ   ‚îú‚îÄ‚îÄ market_trends.md
  ‚îÇ   ‚îî‚îÄ‚îÄ ...
  ‚îÇ
  ‚îî‚îÄ‚îÄ /derived/               # Auto-generated by agents
      ‚îî‚îÄ‚îÄ .gitkeep
```

---

## üöÄ **USAGE**

### **Load Knowledge Base**
```bash
# Load all documents
python kb_loader.py --load

# Clear existing and reload
python kb_loader.py --load --clear

# Use custom directory
python kb_loader.py --load --kb-dir /path/to/docs
```

### **Test Retrieval**
```bash
# Test with a query
python kb_loader.py --test "What are our unit economics?"

# Test ICP knowledge
python kb_loader.py --test "What's our ICP for dental clinics?"

# Test strategy
python kb_loader.py --test "How do we position against competitors?"
```

### **Database Setup**
```bash
# Print SQL to run in Supabase SQL Editor
python kb_loader.py --setup
```

---

## üìù **WHAT YOU NEED TO PROVIDE**

### **Core Documents** (Start with these 5):

1. **`business/company_overview.md`**
   - Company: Hume Health
   - Product: Medical aesthetic devices
   - Unit economics: $35 cost, $200 margin
   - Deal structures
   - Current capacity

2. **`business/unit_economics.md`**
   - Detailed cost breakdown
   - Pricing tiers
   - Volume discounts
   - ROI calculations

3. **`strategy/icp_profile.md`**
   - Dental: 32% conversion rate
   - Med Spa: 18% conversion rate
   - Decision makers
   - Pain points
   - Best messaging per segment

4. **`playbooks/qualification_criteria.md`**
   - HOT/WARM/COOL/COLD tiers
   - Scoring methodology
   - Disqualification criteria

5. **`intelligence/competitor_analysis.md`**
   - Main competitors
   - Their positioning
   - Their pricing
   - How you differentiate

### **Optional Documents** (Add as needed):
- Messaging frameworks
- Objection handling scripts
- Follow-up sequences
- Customer case studies
- Market trends analysis
- Segment performance data

---

## üîß **TECHNICAL DETAILS**

### **Embedding Model**
- **Model**: OpenAI `text-embedding-3-small`
- **Dimensions**: 1536
- **Cost**: $0.00002 per 1K tokens (~$0.64 for typical KB)

### **Text Chunking**
- **Method**: RecursiveCharacterTextSplitter
- **Chunk Size**: 400 characters
- **Overlap**: 50 characters
- **Separators**: Paragraphs, sentences, words

### **Vector Database**
- **Database**: Supabase (PostgreSQL + pgvector)
- **Table**: `knowledge_base`
- **Search Function**: `match_knowledge_base`
- **Index**: IVFFlat (cosine similarity)

### **Supported File Types**
| Type | Extension | Loader |
|------|-----------|--------|
| Markdown | `.md` | UnstructuredMarkdownLoader |
| PDF | `.pdf` | PyPDFLoader |
| Word | `.docx` | Docx2txtLoader |
| Text | `.txt` | TextLoader |
| CSV | `.csv` | CSVLoader (optional) |
| Excel | `.xlsx` | UnstructuredExcelLoader (optional) |

---

## üí∞ **COSTS**

### **One-Time Setup**
- Embeddings: ~$0.64 (for typical 12-doc KB)
- Storage: $0 (Supabase free tier)
- **Total**: ~$0.64

### **Ongoing**
- Retrieval: $0 (Supabase queries are free)
- Updates: ~$0.05 per document update
- **Total**: Negligible

---

## üîÑ **UPDATING KNOWLEDGE BASE**

### **Add New Documents**
```bash
# 1. Create new .md file
echo "# New Content" > strategy/new_doc.md

# 2. Reload (incremental)
python kb_loader.py --load
```

### **Update Existing Documents**
```bash
# 1. Edit the file
vim business/company_overview.md

# 2. Clear and reload
python kb_loader.py --load --clear
```

### **Best Practice**
- Keep KB in version control (Git)
- Document changes in commit messages
- Test retrieval after major updates

---

## üéØ **INTEGRATION WITH AGENT**

Once loaded, the agent can access knowledge via:

### **In Slack**
```
You: "What's our ICP for dental clinics?"

Agent: "Based on our ICP documentation:

**Dental Clinics (Best Performer)**
- Conversion Rate: 32% (vs 18% med spas)
- Profile: $500K+ revenue, 3+ chairs
- Decision Maker: Practice owner/lead dentist

**Why They Convert**:
1. High margins justify premium equipment
2. Patient volume supports ROI
3. Competitive differentiation need

[Sources: strategy/icp_profile.md]"
```

### **Tool Usage**
The agent uses `search_knowledge_base` tool automatically when:
- You ask about ICP, messaging, strategy
- You request competitive analysis
- You need business context for decisions
- You want to understand qualification criteria

---

## üìä **MONITORING**

### **Check What's Loaded**
```sql
-- In Supabase SQL Editor
SELECT 
  metadata->>'category' as category,
  metadata->>'type' as type,
  COUNT(*) as chunks
FROM knowledge_base
GROUP BY category, type
ORDER BY category, type;
```

### **Sample Retrieval**
```sql
-- Test similarity search
SELECT 
  content,
  metadata->>'source' as source,
  1 - (embedding <=> (SELECT embedding FROM knowledge_base LIMIT 1)) as similarity
FROM knowledge_base
ORDER BY similarity DESC
LIMIT 5;
```

---

## ‚ö†Ô∏è **TROUBLESHOOTING**

### **"No documents found"**
- Check that `.md` files exist in subdirectories
- Don't use `.template` extension for real docs
- Verify you're in `/knowledge_base/` directory

### **"Supabase connection failed"**
- Check `SUPABASE_URL` in `.env`
- Use **service role key**, not anon key
- Verify Supabase project is active

### **"Table does not exist"**
- Run setup SQL in Supabase SQL Editor
- Check table name: `knowledge_base` (not `documents`)

### **"Poor retrieval quality"**
- Add more context to documents
- Increase chunk size (edit kb_loader.py)
- Add more documents on the topic

---

## üìö **DOCUMENTATION**

- **`SETUP_GUIDE.md`**: Complete setup instructions
- **`kb_loader.py`**: Source code with inline docs
- **`*.template`**: Example document templates
- **`requirements.txt`**: Dependencies list

---

## üéä **WHAT'S NEXT**

1. **Create Core Documents** (5 docs, ~2 hours)
   - Use templates as starting point
   - Fill in YOUR business specifics
   
2. **Load and Test** (~10 minutes)
   - Run `python kb_loader.py --load`
   - Test retrieval with sample queries
   
3. **Iterate** (ongoing)
   - Add more documents as needed
   - Refine based on agent usage
   - Update as business evolves

4. **Phase 1.5.5 Complete!** üéâ
   - Agent now has business context
   - Strategic recommendations are Hume-specific
   - RAG system fully operational

---

**Questions?** Check SETUP_GUIDE.md or ask the agent! ü§ñ

**Last Updated**: October 20, 2025  
**Status**: ‚úÖ Ready for knowledge base population
